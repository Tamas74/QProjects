<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 12">
<meta name=Originator content="Microsoft Word 12">
<link rel=File-List href="mail4-Dateien/filelist.xml">
<link rel=Edit-Time-Data href="mail4-Dateien/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>v-ruihuj</o:Author>
  <o:Template>NormalEmail.dotm</o:Template>
  <o:Revision>1</o:Revision>
  <o:Created>2007-04-24T07:38:00Z</o:Created>
  <o:Pages>1</o:Pages>
  <o:Words>1612</o:Words>
  <o:Characters>9195</o:Characters>
  <o:Lines>76</o:Lines>
  <o:Paragraphs>21</o:Paragraphs>
  <o:CharactersWithSpaces>10786</o:CharactersWithSpaces>
  <o:Version>12.00</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<link rel=themeData href="mail4-Dateien/themedata.thmx">
<link rel=colorSchemeMapping href="mail4-Dateien/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>0</w:Zoom>
  <w:TrackMoves/>
  <w:TrackFormatting/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:DoNotExpandShiftReturn/>
   <w:BreakWrappedTables/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="--"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073750139 0 0 159 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520082689 -1073717157 41 0 66047 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";}
h2
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Überschrift 2 Zchn";
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	font-weight:bold;}
h3
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Überschrift 3 Zchn";
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Sprechblasentext Zchn";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;}
span.berschrift2Zchn
	{mso-style-name:"Überschrift 2 Zchn";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Überschrift 2";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#4F81BD;
	mso-themecolor:accent1;
	font-weight:bold;}
span.berschrift3Zchn
	{mso-style-name:"Überschrift 3 Zchn";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Überschrift 3";
	mso-ansi-font-size:11.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#4F81BD;
	mso-themecolor:accent1;
	font-weight:bold;}
span.SprechblasentextZchn
	{mso-style-name:"Sprechblasentext Zchn";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Sprechblasentext;
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	mso-ascii-font-family:Tahoma;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
span.E-MailFormatvorlage22
	{mso-style-type:personal;
	mso-style-noshow:yes;
	mso-style-unhide:no;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-hansi-font-family:Calibri;
	color:windowtext;}
p.Heading2, li.Heading2, div.Heading2
	{mso-style-name:"Heading 2";
	mso-style-unhide:no;
	mso-style-link:"Heading 2 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
p.Heading3, li.Heading3, div.Heading3
	{mso-style-name:"Heading 3";
	mso-style-unhide:no;
	mso-style-link:"Heading 3 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
p.BalloonText, li.BalloonText, div.BalloonText
	{mso-style-name:"Balloon Text";
	mso-style-unhide:no;
	mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:709259863;
	mso-list-template-ids:-243624806;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level2
	{mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level3
	{mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level5
	{mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level6
	{mso-level-tab-stop:216.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level7
	{mso-level-tab-stop:252.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level8
	{mso-level-tab-stop:288.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level9
	{mso-level-tab-stop:324.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1
	{mso-list-id:745999679;
	mso-list-template-ids:-1829576014;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Normale Tabelle";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:36.0pt'>

<div class=Section1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><span lang=EN style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN'>Interacting with 2D on 3D in WPF<o:p></o:p></span></h2>

<p><span lang=EN style='mso-ansi-language:EN'>Interacting with 2D placed on 3D
is now possible in v1 of the Windows Presentation Foundation!<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>In between shipping Vista and
planning the next version of WPF, we realized that with a clever implementation
it was possible to provide this feature today on v1 bits, and I’m happy to
report that as of now, the binaries (and source code to them) needed to do this
are available for download (<a
href="http://www.codeplex.com/3DTools/Release/ProjectReleases.aspx?ReleaseId=577">here</a>).<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>The download also contains two
sample applications - InteractiveViewport3DSample and Channel9Demo - which
illustrate how to use the code.&nbsp; So if you just want to dive right in to
2D on 3D, that's a good place to start.&nbsp;<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>The rest of this post will
describe how to use this feature as a developer, as well as how it’s
implemented behind the scenes.&nbsp; If you want the video version though,
which includes a cool demo of an app we made with the 2D on 3D code (photo
shown below – source here <a
href="http://www.codeplex.com/3DTools/Release/ProjectReleases.aspx?ReleaseId=2058">http://www.codeplex.com/3DTools/Release/ProjectReleases.aspx?ReleaseId=2058</a>),
check it out on Channel9&nbsp;(<a
href="http://channel9.msdn.com/Showpost.aspx?postid=266036">here</a>).<o:p></o:p></span></p>

<p><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Picture_x0020_1" o:spid="_x0000_i1025" type="#_x0000_t75"
 alt="Flickr Application" style='width:471pt;height:301.5pt'>
 <v:imagedata src="mail4-Dateien/image001.jpg" o:href="cid:image001.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=628 height=402
src="mail4-Dateien/image001.jpg" alt="Flickr Application" v:shapes="Picture_x0020_1"><![endif]><span
lang=EN style='mso-ansi-language:EN'><o:p></o:p></span></p>

<h3><span lang=EN style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:
EN'>How do you use it?<o:p></o:p></span></h3>

<p><span lang=EN style='mso-ansi-language:EN'>There are two main classes needed
to add 2D on 3D to you app: Interactive3DDecorator and
InteractiveVisual3D.&nbsp; The Interactive3DDecorator handles the majority of
the work that allows the 2D on 3D interaction to happen.&nbsp; To use it, you
simply place it around the Viewport3D that you intend to make
interactive.&nbsp; So in XAML, you have:<o:p></o:p></span></p>

<p><span lang=EN style='font-size:10.0pt;font-family:"Courier New";mso-ansi-language:
EN'>&lt;local:Interactive3DDecorator&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Viewport3D&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; …<br>
&nbsp;&nbsp;&nbsp; &lt;/Viewport3D&gt;<br>
&lt;/local:Interactive3DDecorator&gt;<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>Then, to actually add interactive
2D on 3D objects in to your scene, you use the InteractiveVisual3D class.&nbsp;
InteractiveVisual3D is a subclass of ModelVisual3D and provides the following
dependency properties which set up the interactive 2D on 3D:<o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span lang=EN
     style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN'>Geometry&nbsp;
     - The Geometry3D that is to become the content of the InteractiveVisual3D
     . <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span lang=EN
     style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN'>Visual
     – The 2D you want to interact with on the 3D geometry. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span lang=EN
     style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN'>Material
     – A user specified material to use on the 3D object.&nbsp; By default, a
     DiffuseMaterial is used. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span lang=EN
     style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN'>IsBackVisible
     – Indicates whether the material used for the front face should also be
     mirrored on the back face.<o:p></o:p></span></li>
</ul>

<p><span lang=EN style='mso-ansi-language:EN'>The first two properties,
Geometry and Visual, are the primary ones needed.&nbsp; They allow the geometry
that should be used to bet set, as well as the Visual that should appear on
that geometry.&nbsp; For example, the below XAML code demonstrates how to
create an InteractiveVisual3D.<o:p></o:p></span></p>

<p><span lang=EN style='font-size:10.0pt;font-family:"Courier New";mso-ansi-language:
EN'>&lt;local:InteractiveVisual3D Geometry=&quot;{StaticResource
PlaneMesh}&quot;&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;local:InteractiveVisual3D.Visual&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Label
Content=&quot;Sample UI&quot; /&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Button
Content=&quot;Close Window&quot;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBox
/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/local:InteractiveVisual3D.Visual&gt;<br>
&lt;/local:InteractiveVisual3D&gt;<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>The other properties allow for
fine tuning of the object’s appearance.&nbsp; The Material property allows a
user to create their own material for the object.&nbsp; To do so, a user can
create a material as always, and then specify using the IsInteractiveMaterial
attached property which material is intended to be “interactive” (i.e. the
VisualBrush created using the passed in Visual is set as the Brush for that
material). Note, this attached property must be set to true on at least one
material – otherwise an exception will be thrown.&nbsp; If you ever want to
disable interaction, you can set “IsHitTestVisible” on the Visual to be
false.&nbsp; As an example of setting a custom material, the following code
sets the material to be composed of a DiffuseMaterial, which will contain the
visual brush, and a SpecularMaterial.<o:p></o:p></span></p>

<p><span lang=EN style='font-size:10.0pt;font-family:"Courier New";mso-ansi-language:
EN'>&lt;local:InteractiveVisual3D.Material&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;MaterialGroup&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DiffuseMaterial
local:InteractiveVisual3D.IsInteractiveMaterial=&quot;True&quot;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;SpecularMaterial
Brush=&quot;Red&quot; /&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/MaterialGroup&gt;<br>
&lt;/local:InteractiveVisual3D.Material&gt;<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>Finally, IsBackVisible sets the
material used on the front face to also be used on the back face.&nbsp;
Currently, the Interactive3DDecorator does not distinguish between front and
back faces, so this allows for there to be interaction with the back face as
well.<o:p></o:p></span></p>

<h3><strong><span lang=EN style='mso-fareast-font-family:"Times New Roman";
mso-ansi-language:EN'>How does it work?</span></strong><span lang=EN
style='mso-fareast-font-family:"Times New Roman";mso-ansi-language:EN'><o:p></o:p></span></h3>

<p><span lang=EN style='mso-ansi-language:EN'>At a very high level, the interaction
with 2D on 3D is achieved by really interacting with a hidden version of that
2D content in 2D.&nbsp; The 2D is positioned such that the point in 3D the
mouse is over is the exact same point as the mouse is over on the hidden 2D
version.&nbsp; Then, when the user clicks, etc… they are interacting with
exactly the same location.&nbsp; If you want to see this for yourself, you can
set the “Debug” property on Interactive3DDecorator to true, which makes the
hidden layer partially visible. <o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>The Interactive3DDecorator then
consists of two elements: the 3D content that is displayed within it and a
hidden layer that is used to position and display the 2D content that is being
interacted with.&nbsp; Depending on what 2D content on 3D is being interacted
with, the hidden layer changes to hold that 2D content.&nbsp; The images below
give a visual representation of what is going on.&nbsp; The first photo is just
of the 2D content we wish to place on 3D.&nbsp; The second is that 2D content
on 3D.&nbsp; And finally, the third image shows how the 2D on 3D interaction
takes place.&nbsp; When the mouse moves over the “B” in the button, the hidden
layer (shown to be only partially transparent for this example) is moved such
that the mouse is over the same point in the hidden layer as it is in the 3D
scene.<o:p></o:p></span></p>

<p><!--[if gte vml 1]><v:shape id="Picture_x0020_2" o:spid="_x0000_i1026"
 type="#_x0000_t75" alt="ex1" style='width:185.5pt;height:190.5pt'>
 <v:imagedata src="mail4-Dateien/image002.jpg" o:href="cid:image002.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=247 height=254
src="mail4-Dateien/image002.jpg" alt=ex1 v:shapes="Picture_x0020_2"><![endif]><!--[if gte vml 1]><v:shape
 id="Picture_x0020_3" o:spid="_x0000_i1027" type="#_x0000_t75" alt="ex2"
 style='width:209.5pt;height:190.5pt'>
 <v:imagedata src="mail4-Dateien/image003.jpg" o:href="cid:image003.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=279 height=254
src="mail4-Dateien/image003.jpg" alt=ex2 v:shapes="Picture_x0020_3"><![endif]><!--[if gte vml 1]><v:shape
 id="Picture_x0020_4" o:spid="_x0000_i1028" type="#_x0000_t75" alt="ex3"
 style='width:209.5pt;height:190.5pt'>
 <v:imagedata src="mail4-Dateien/image004.jpg" o:href="cid:image004.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=279 height=254
src="mail4-Dateien/image004.jpg" alt=ex3 v:shapes="Picture_x0020_4"><![endif]><span
lang=EN style='mso-ansi-language:EN'><br>
&nbsp; <br>
To figure out where to position the hidden layer works as follows.&nbsp; When
the mouse moves in the 3D scene, a ray is shot in to the 3D scene to see if it
intersects any object.&nbsp; If it hit an object, and it is an
InteractiveVisual3D, we can use the return parameters from the intersection to
compute the texture coordinate that was hit.&nbsp; Then from these, we can map
from the (u,v) value of the texture coordinate, on to an x,y point on the 2D
visual, which is the point we need to place under the mouse.&nbsp; More
specifically, the code assumes texture coordinates are all in the range (0,0)
to (1,1) – i.e. upper left to lower right of the image (for those planning to
use this, this is important to know, since your texture coordinates need to be
within this range to enable interaction with the 2D content).&nbsp; Then the
point on the 2D object that was hit is simply (u * Width, v * Height). <o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>One of the great things about this
method then is that the only event that needs to be tracked is when the mouse
moves.&nbsp; There’s no need for catching and forwarding on every type of
event: the hidden layer takes care of all of this work.&nbsp;&nbsp; <o:p></o:p></span></p>

<p><strong><span lang=EN style='mso-ansi-language:EN'>Positioning With Capture</span></strong><span
lang=EN style='mso-ansi-language:EN'><o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>There’s one very interesting
“gotcha” though: what happens when one of the 2D objects grabs capture and then
you move off the 3D mesh it is on?&nbsp; For example, you select some text, and
then move the mouse above that selected text, or click and hold on a button,
and then move away from it.&nbsp; Correct hidden content positioning becomes
more complicated in this case.&nbsp; The problem becomes difficult for many
reasons.&nbsp; In the normal 2D situation, both the mouse position and the 2D
content exist in the same plane.&nbsp; The transformation that is applied to
the 2D content can be used to transform the mouse position to the content’s
local coordinate system.&nbsp; However in 3D, due to the projection of 3D on to
a 2D plane, the mouse’s position actually corresponds to a line in 3D
space.&nbsp; In addition, the element with capture could also be mapped to any
arbitrary geometry.&nbsp; When the mouse is over the 3D object, hit testing
tells us where it is relative to the 2D visual.&nbsp; When it is off the 3D
object, due to the above issues, there is no longer a straight forward answer
to this question: the 2D point corresponds to a 3D line and the 2D content
could be on arbitrary 3D geometry.&nbsp; Also, because the element has capture,
it wants to receive all events.&nbsp; Before, we only needed to be sure that
the mouse was over the correct object at all times.&nbsp; Now we need to
position the hidden visual such that it is in the proper position relative to
the object that has capture.<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>To solve this issue, the code
takes the following approach:&nbsp; The overall idea is to reduce the 3D
problem back to 2D.&nbsp; In the normal 2D case, the transformations applied to
the content can be used to convert the mouse position to the content’s local
coordinate system.&nbsp; This transformed position then lets the content know
where the mouse is relative to it.&nbsp; In 3D, due to the many orientations of
the geometry and texture coordinate layouts, it’s difficult to say where a 3D
point is in the relative coordinate system of the 2D content on 3D.&nbsp; To
approximate this, the outline of the 2D content on 3D, after it has been
projected to screen space, is computed, and then the mouse is positioned based
on this projection.&nbsp; <o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>For example, take the 3 images
below.&nbsp; The first is the 2D content on 3D.&nbsp; In the second image, text
is selected, and the mouse is moved to a point off the object.&nbsp; The third
image is the outline of the text box (the object that has capture).&nbsp; This
outline is then used to position the hidden visual.&nbsp; <o:p></o:p></span></p>

<p><!--[if gte vml 1]><v:shape id="Picture_x0020_5" o:spid="_x0000_i1029"
 type="#_x0000_t75" alt="ex4" style='width:133.5pt;height:135pt'>
 <v:imagedata src="mail4-Dateien/image005.jpg" o:href="cid:image005.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=178 height=180
src="mail4-Dateien/image005.jpg" alt=ex4 v:shapes="Picture_x0020_5"><![endif]><!--[if gte vml 1]><v:shape
 id="Picture_x0020_6" o:spid="_x0000_i1030" type="#_x0000_t75" alt="ex5"
 style='width:133.5pt;height:135pt'>
 <v:imagedata src="mail4-Dateien/image006.jpg" o:href="cid:image006.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=178 height=180
src="mail4-Dateien/image006.jpg" alt=ex5 v:shapes="Picture_x0020_6"><![endif]><!--[if gte vml 1]><v:shape
 id="Picture_x0020_7" o:spid="_x0000_i1031" type="#_x0000_t75" alt="ex6"
 style='width:133pt;height:134.5pt'>
 <v:imagedata src="mail4-Dateien/image007.jpg" o:href="cid:image007.jpg@01C785B4.09DF11D0"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=177 height=179
src="mail4-Dateien/image007.jpg" alt=ex6 v:shapes="Picture_x0020_7"><![endif]><span
lang=EN style='mso-ansi-language:EN'><br>
&nbsp;&nbsp; <br>
After the outline is available, The closest point on this outline to the mouse
position is computed, and then this point on the outline is considered what was
“hit” and it is placed under the moue position (hence, highlighting up to the
“T” in the middle image below).&nbsp; Since we place the mouse by the closest
edge point, the interaction tends to behave as it would in 2D, since we
position the hidden content based on what the mouse is closest to on the 2D
content on 3D.&nbsp; By placing it at the closest edge point, we are explicitly
stating about where we expect the mouse to be relative to the 2D on 3D
element’s orientation.<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>This method helps provide an
intuitive response to the interaction, since the interaction happens with the
closest point on the object with capture to the mouse.<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>&nbsp;<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>Enjoy using it!&nbsp; We’ve had a
lot of fun building this, and can’t wait to see what kind of incredible
applications will be built with it!<o:p></o:p></span></p>

<p><span lang=EN style='mso-ansi-language:EN'>-Kurt<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
