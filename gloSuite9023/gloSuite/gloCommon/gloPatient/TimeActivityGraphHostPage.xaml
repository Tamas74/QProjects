<UserControl x:Class="gloPatient.TimeActivityGraphHostPage"
  
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       xmlns:ctl="clr-namespace:Microsoft.Cui.Controls;assembly=Microsoft.Cui.WPFControls" 
          xmlns:system="clr-namespace:System;assembly=mscorlib"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:ctrl="clr-namespace:Microsoft.Cui.Controls;assembly=Microsoft.Cui.WPFControls" 
         xmlns:local="clr-namespace:Microsoft.Cui.Controls;assembly=Microsoft.Cui.WPFControls" 
              xmlns:local2="clr-namespace:Microsoft.Cui.SamplePages"
 
             xmlns:samplepages="clr-namespace:Microsoft.Cui.SamplePages"
          xmlns:controls="clr-namespace:Microsoft.Cui.Controls;assembly=Microsoft.Cui.WPFControls"
 
            >
    <UserControl.Resources>

        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!--<ResourceDictionary Source="/gloPatient;component/Graphing/SearchAndPrescribe/ResourceDictionaries/DefaultResourceDictionary.xaml" />-->
                <ResourceDictionary Source="/gloPatient;component/Graphing/ResourceDictionaries/TimeActivityGraphHost.xaml" />
            
            </ResourceDictionary.MergedDictionaries>

            <!-- TreeView CheckBox style -->
           
            <Style x:Key="trvchksty"  TargetType="CheckBox"  >
                <Setter Property="Foreground" Value="#1f497d"></Setter>
            </Style>
           
            <ctl:DictionaryToStringConverter x:Key="dictionaryToStringConverter"/>
            <ctl:DictionaryToDataTemplateConverter x:Key="dictionaryToDataTemplateConverter"/>

            <!-- Element styles -->
            <ControlTemplate TargetType="ToolTip" x:Key="ToolTipTemplate">
                <Border BorderBrush="#FF080808" BorderThickness="1,1,1,1" Background="#FFFFFBE9" CornerRadius="2">
                    <Grid>
                        <ContentPresenter Grid.Column="0"
                                        Content="{TemplateBinding Content}"
                                        ContentTemplate="{TemplateBinding ContentTemplate}"
                                        Margin="{TemplateBinding Padding}" 
                                        VerticalAlignment="Top"
                                        HorizontalAlignment="Left"/>

                    </Grid>
                </Border>
            </ControlTemplate>

            <Style TargetType="Button" x:Key="ELEMENT_directionArrowStyle">
                <Setter Property="Canvas.ZIndex" Value="1000" />
                <Setter Property="Visibility"  Value="Collapsed" />
                <Setter Property="IsHitTestVisible" Value="True" />
                <Setter Property="IsTabStop" Value="False" />
                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <Rectangle Fill="Transparent" />
                                <Polygon Points="8,0, 16,6, 12,6, 12,12, 4,12, 4,6, 0,6" Fill="#BB0000" Stroke="#000000" Opacity="0.5" StrokeThickness="1" />
                                <ContentPresenter Margin="{TemplateBinding Padding}" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                <ToolTipService.ToolTip>
                                    <ToolTip Template="{StaticResource ToolTipTemplate}">
                                        <ToolTip.Content>
                                            <TextBlock FontWeight="Normal" HorizontalAlignment="Left" TextWrapping="NoWrap" Text="Scroll to view more data"></TextBlock>
                                        </ToolTip.Content>
                                    </ToolTip>
                                </ToolTipService.ToolTip>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <DataTemplate x:Key="Square">
                <Rectangle Canvas.ZIndex="10" Width="5" Height="5" Fill="#990000" Stroke="Black" StrokeThickness="1" ctl:GraphBase.XOffset="-2.5" ctl:GraphBase.YOffset="-2.5" />
            </DataTemplate>
            <DataTemplate x:Key="Circle">
                <Ellipse Canvas.ZIndex="10" Width="5" Height="5" Fill="#2932E0" Stroke="Black" StrokeThickness="1" ctl:GraphBase.XOffset="-2.5" ctl:GraphBase.YOffset="-2.5" />
            </DataTemplate>
            <DataTemplate x:Key="Triangle">
                <Polygon Canvas.ZIndex="10" Height="6" Width="6" ctl:GraphBase.XOffset="-3" ctl:GraphBase.YOffset="-3" Stroke="Black" StrokeThickness="1"
                            Points="0,6 6,6 3,0" Fill="#B966B9" />
            </DataTemplate>
            <DataTemplate x:Key="Diamond">
                <Rectangle Canvas.ZIndex="10" Width="5" Height="5" Fill="#CC6600" Stroke="Black" StrokeThickness="1" ctl:GraphBase.XOffset="-2.5" ctl:GraphBase.YOffset="-2.5">
                    <Rectangle.RenderTransform>
                        <RotateTransform Angle="45" CenterX="2.5" CenterY="2.5" />
                    </Rectangle.RenderTransform>
                </Rectangle>
            </DataTemplate>

            <DataTemplate x:Key="IBarMarker">
                <Grid Canvas.ZIndex="10" Height="9" Width="9" ctl:GraphBase.XOffset="-4.5" ctl:GraphBase.YOffset="-1.5" ctl:GraphBase.SnapToPixels="True">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="3"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="3"/>
                    </Grid.RowDefinitions>
                    <Rectangle Grid.Row="0" VerticalAlignment="Top" Height="3" Width="9" Fill="Black"/>
                    <Rectangle Grid.Row="1" HorizontalAlignment="Center" Fill="Black" Width="1"/>
                    <Rectangle Grid.Row="2" VerticalAlignment="Bottom" Height="3" Width="9" Fill="Black"/>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="IBarPoint">
                <ctl:GraphPoint Y1="{Binding Y1}" Y2="{Binding Y2}" X1="{Binding DateTime}"/>
            </DataTemplate>
            <DataTemplate x:Key="IBarLabel">
                <Border Canvas.ZIndex="9999" RenderTransformOrigin="0, 1"
                                            BorderThickness="1"     
                                            Background="White"
                                            BorderBrush="DarkGray" Padding="0" 
                                            CornerRadius="2"                                            
                                            ctl:GraphBase.XOffset="2" 
                                            ctl:GraphBase.YOffset="-12"
                                        >

                    <StackPanel Margin="0,-1,0,-1">
                        <TextBlock x:Name="ELEMENT_labelTextBlock"  HorizontalAlignment="Left" Margin="0,0,0,0" Text="{Binding Path=DataContext}" />
                    </StackPanel>

                </Border>
            </DataTemplate>

            <!-- Some styles for the graph-->

            <Style TargetType="ctl:TimeGraphBase" x:Key="OverriddenDefaultStyle">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Grid>
                                <Border BorderThickness="1" BorderBrush="Gray" CornerRadius="4">
                                    <Grid x:Name="ELEMENT_layoutRoot" Background="{TemplateBinding Background}">
                                        <Grid.Resources>
                                            <DataTemplate x:Key="ELEMENT_dynamicMainLayerTemplate">
                                                <Grid x:Name="ELEMENT_dynamicMainLayer">
                                                    <Canvas Background="White" Canvas.ZIndex="10" VerticalAlignment="Top" x:Name="ELEMENT_dynamicTopAxisLayerViewport" Height="30" Visibility="Collapsed">
                                                        <Canvas x:Name="ELEMENT_dynamicTopAxisLayer">

                                                        </Canvas>
                                                    </Canvas>
                                                    <Canvas Canvas.ZIndex="5" x:Name="ELEMENT_dynamicPlotLayerViewport">
                                                        <Canvas x:Name="ELEMENT_dynamicPlotLayer">
                                                        </Canvas>
                                                    </Canvas>
                                                </Grid>
                                            </DataTemplate>

                                            <DataTemplate x:Key="ELEMENT_collisionTemplate">
                                                <Grid Canvas.ZIndex="6" Opacity="0.6" Width="23" Height="19"  ctl:GraphBase.XOffset="0" ctl:GraphBase.YOffset="-23">
                                                    <Path Margin="0.4,0.4,0.2,0.2" Fill="#FFF3F500" Stretch="Fill" Stroke="#FF000000" Data="M0.75,14.125 C17.375,14.125 17.125,14.125 17.125,14.125 L9.1251093,0.125 z" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" StrokeThickness="1.2"/>
                                                    <Path RenderTransformOrigin="0,0" Margin="10.25,6.125,9.75,2.75" Fill="#FF000000" Stretch="Fill" Data="M1.9921874,9.7406769 C2.2382813,9.7406769 2.4482422,9.8256378 2.6220703,9.9955597 C2.7958984,10.165482 2.8828125,10.371536 2.8828125,10.613724 C2.8828125,10.887161 2.7949219,11.102005 2.6191406,11.258255 C2.4433594,11.414505 2.2382813,11.49263 2.0039063,11.49263 C1.765625,11.49263 1.5576172,11.415482 1.3798828,11.261185 C1.2910156,11.184036 1.2243652,11.091507 1.1799316,10.983597 C1.135498,10.875687 1.1132813,10.752396 1.1132813,10.613724 C1.1132813,10.371536 1.1982422,10.165482 1.3681641,9.9955597 C1.5380859,9.8256378 1.7460938,9.7406769 1.9921874,9.7406769 z M2.0390625,2.6215363 C2.2070313,2.6215363 2.347168,2.650589 2.4594727,2.7086945 C2.5717773,2.7667999 2.65625,2.8539581 2.7128906,2.9701691 C2.7695313,3.08638 2.8120117,3.2282257 2.840332,3.3957062 C2.8686523,3.5631866 2.8828125,3.7563019 2.8828125,3.9750519 C2.8828125,4.2328644 2.8691406,4.4945831 2.8417969,4.7602081 L2.5898438,7.64888 C2.5625,7.99263 2.5039063,8.2563019 2.4140625,8.4398956 C2.3691406,8.5316925 2.3095703,8.6005402 2.2353516,8.6464386 C2.1611328,8.692337 2.0722656,8.7152863 1.96875,8.7152863 C1.8632813,8.7152863 1.7739258,8.6930695 1.7006836,8.6486359 C1.6274414,8.6042023 1.5703125,8.5375519 1.5292969,8.4486847 C1.4882813,8.3598175 1.453125,8.247757 1.4238281,8.1125031 C1.3945313,7.9772491 1.3710938,7.8188019 1.3535156,7.6371613 L1.1660156,4.8305206 C1.1484375,4.5570831 1.1352539,4.3222198 1.1264648,4.1259308 C1.1176758,3.9296417 1.1132813,3.7719269 1.1132813,3.6527863 C1.1132813,3.3285675 1.1982422,3.0756378 1.3681641,2.8939972 C1.453125,2.8031769 1.5515137,2.7350616 1.6633301,2.6896515 C1.7751465,2.6442413 1.9003906,2.6215363 2.0390625,2.6215363 z">
                                                        <Path.RenderTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                                                                <SkewTransform AngleX="0" AngleY="0"/>
                                                                <RotateTransform Angle="0"/>
                                                                <TranslateTransform X="0" Y="0"/>
                                                            </TransformGroup>
                                                        </Path.RenderTransform>
                                                    </Path>
                                                    <ToolTipService.ToolTip>
                                                        <ToolTip Template="{StaticResource ToolTipTemplate}">
                                                            <ToolTip.Content>
                                                                <StackPanel Width="125" Margin="5,0,5,0">
                                                                    <TextBlock FontWeight="Bold" HorizontalAlignment="Left" TextWrapping="Wrap" Text="Overcrowded data"></TextBlock>
                                                                    <TextBlock HorizontalAlignment="Left" TextWrapping="Wrap"><Run Text="Adjust your timescale to see this data."/></TextBlock>
                                                                </StackPanel>
                                                            </ToolTip.Content>
                                                        </ToolTip>
                                                    </ToolTipService.ToolTip>
                                                </Grid>
                                            </DataTemplate>
                                            <DataTemplate x:Key="ELEMENT_dataMarkerTemplate">
                                                <Rectangle Canvas.ZIndex="10" Height="5" Width="5" Fill="Blue" Stroke="Black" StrokeThickness="3" ctl:GraphBase.XOffset="-2.5" ctl:GraphBase.YOffset="-2.5" />
                                            </DataTemplate>
                                            <DataTemplate x:Key="ELEMENT_PointTemplate">
                                                <ctl:GraphPoint Canvas.ZIndex="9999" Y1="{Binding Y1}"  X1="{Binding DateTime}"/>
                                            </DataTemplate>
                                            <DataTemplate x:Key="ELEMENT_LabelTemplate">
                                                <Border Canvas.ZIndex="9999" RenderTransformOrigin="0, 1"
                                            BorderThickness="1"     
                                            Background="White"
                                            BorderBrush="DarkGray" Padding="0" 
                                            CornerRadius="2"                                                
                                            ctl:GraphBase.XOffset="2" 
                                            ctl:GraphBase.YOffset="-12"
                                        >

                                                    <StackPanel Margin="0,-1,0,-1">
                                                        <TextBlock x:Name="ELEMENT_labelTextBlock"  HorizontalAlignment="Left" Margin="0,0,0,0" Text="{Binding Path=DataContext}" />
                                                    </StackPanel>

                                                </Border>
                                            </DataTemplate>

                                            <ScaleTransform x:Key="ELEMENT_LabelTransform" ScaleX="1.4" ScaleY="1.4">
                                            </ScaleTransform>
                                            <DataTemplate x:Key="ELEMENT_XAxisLabelTemplate">
                                                <TextBlock FontSize="11" />
                                            </DataTemplate>
                                            <DataTemplate x:Key="ELEMENT_YAxisLabelTemplate">
                                                <TextBlock FontSize="11" Margin="3,0,0,0" />
                                            </DataTemplate>
                                            <local:TimeFrequency x:Key="DefaultVisibleWindow" Unit="Minute" Value="5" />
                                        </Grid.Resources>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"/>
                                            <RowDefinition Height="0"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="0"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="20" />
                                        </Grid.ColumnDefinitions>

                                        <Grid Grid.Row="0" Grid.ColumnSpan="2" Background="{TemplateBinding Background}" x:Name="ELEMENT_TitleArea">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="5*" />
                                                <ColumnDefinition Width="5*" />
                                                <ColumnDefinition Width="80" />
                                            </Grid.ColumnDefinitions>
                                            <Rectangle RadiusX="2" RadiusY="2" Grid.ColumnSpan="3">
                                            </Rectangle>
                                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0" HorizontalAlignment="Left">
                                                <TextBlock Margin="5,0,0,0" FontSize="12" FontWeight="Bold" Text="{Binding Title}" ></TextBlock>
                                                <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding Units}" ToolTipService.ToolTip="{Binding UnitsDescription}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="1" HorizontalAlignment="Right" Visibility="{Binding ShowNormalRange}">
                                                <TextBlock Margin="5,0,0,0" FontSize="12" Text="Adult normal range"></TextBlock>
                                                <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding NormalRangeMinimumValue}"></TextBlock>
                                                <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="-"></TextBlock>
                                                <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding NormalRangeMaximumValue}"></TextBlock>
                                                <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding Units}" ToolTipService.ToolTip="{Binding UnitsDescription}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Margin="0,2,1,2" VerticalAlignment="Center" Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                                <ctl:CuiToggleButton IsTabStop="False" Width="50" Margin="5,0,0,0" x:Name="ELEMENT_ScaleToFit" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                    <ctl:CuiToggleButton.Content>
                                                        <Grid Background="Transparent" Width="50" Height="20" ToolTipService.ToolTip="Scale to fit all data">
                                                            <Polyline Points="25,0 25,5 28,3" Stroke="Black"/>
                                                            <Polyline Points="25,5 22,3" Stroke="Black"/>
                                                            <Polyline Points="2,12 12,2 35,10 45,3" Stroke="Blue" />
                                                            <Polyline Points="25,18 25,10 28,12" Stroke="Black"/>
                                                            <Polyline Points="25,10 22,12" Stroke="Black"/>
                                                        </Grid>
                                                    </ctl:CuiToggleButton.Content>
                                                    <ctl:CuiToggleButton.PressedStateContent>
                                                        <Grid Width="50" Height="20" Background="Orange" ToolTipService.ToolTip="Return to default scale">
                                                            <Polyline Points="25,7 25,0 28,3" Stroke="Black"/>
                                                            <Polyline Points="25,0 22,3" Stroke="Black"/>
                                                            <Polyline Points="2,12 12,2 35,10 45,3" Stroke="Blue" />
                                                            <Polyline Points="25,8 25,14 28,11" Stroke="Black"/>
                                                            <Polyline Points="25,14 22,11" Stroke="Black"/>
                                                        </Grid>
                                                    </ctl:CuiToggleButton.PressedStateContent>
                                                </ctl:CuiToggleButton>
                                                <ctl:CuiToggleButton IsTabStop="False" Width="20" x:Name="ELEMENT_MinimizeToTitle" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                    <ctl:CuiToggleButton.Content>
                                                        <Grid Background="Transparent" ToolTipService.ToolTip="Minimize" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <Rectangle Margin="0,8,0,0" Height="2" Width="10" Stroke="#FF000000" StrokeThickness="2" />
                                                        </Grid>
                                                    </ctl:CuiToggleButton.Content>
                                                    <ctl:CuiToggleButton.PressedStateContent>
                                                        <Grid Background="Transparent" ToolTipService.ToolTip="Maximize" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                            <Rectangle Height="10" Width="10" Stroke="#FF000000" StrokeThickness="2" />
                                                        </Grid>
                                                    </ctl:CuiToggleButton.PressedStateContent>
                                                </ctl:CuiToggleButton>
                                            </StackPanel>
                                        </Grid>

                                        <Grid Grid.Row="1" Background="Gray" Margin="5,0,30,0" Visibility="Collapsed">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Border BorderBrush="Gray" BorderThickness="1,1,1,0" Grid.Column="0">
                                                <TextBlock Text="" x:Name="ELEMENT_XAxisTitleStartDate" FontSize="14" />
                                            </Border>
                                            <Border BorderBrush="Gray" BorderThickness="1,1,1,0" Grid.Column="2">
                                                <TextBlock Text="" x:Name="ELEMENT_XAxisTitleEndDate" HorizontalAlignment="Right" FontSize="14"/>
                                            </Border>
                                        </Grid>

                                        <Canvas Grid.Row="2" Canvas.ZIndex="10" Margin="5,0,30,5" x:Name="ELEMENT_dynamicMainLayerViewport">
                                            <Button x:Name="ELEMENT_directionArrowUp" Style="{StaticResource ELEMENT_directionArrowStyle}">
                                            </Button>
                                            <Button x:Name="ELEMENT_directionArrowDown" Style="{StaticResource ELEMENT_directionArrowStyle}">
                                                <Button.RenderTransform>
                                                    <RotateTransform Angle="180"/>
                                                </Button.RenderTransform>
                                            </Button>
                                        </Canvas>

                                        <Canvas Grid.Row="2" Canvas.ZIndex="5" Margin="5,0,0,5" x:Name="ELEMENT_nonDynamicRightAxisViewPort" Background="White">
                                            <Canvas x:Name="ELEMENT_NonDynamicRightAxisLabels">
                                            </Canvas>
                                            <Canvas x:Name="ELEMENT_NonDynamicRightAxisLines">
                                            </Canvas>
                                        </Canvas>

                                        <ScrollBar Grid.Row="2" Margin="2,0,2,5" Orientation="Vertical" Grid.Column="1" Minimum="-155" Maximum="155" Value="0" SmallChange="5" LargeChange="10" x:Name="ELEMENT_scrollBarVertical"/>
                                        <ScrollBar Margin="2,2,2,2" Grid.Row="3" Orientation="Horizontal" x:Name="ELEMENT_scrollBar"/>

                                    </Grid>
                                </Border>
                                <Rectangle x:Name="FocusVisualElement" Opacity="0" IsHitTestVisible="False" StrokeThickness="1" Stroke="Black" StrokeDashArray="3 4" Margin="1, 1, 1, 1" />
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <DataTemplate x:Key="BasicBoldTemplate">
                <Grid Height="Auto" Width="Auto" Margin="0,0,0,5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock FontWeight="Bold" TextWrapping="Wrap" Grid.Column="0" Grid.Row="1" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DrugName'}"/>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="BasicTemplate">
                <Grid Height="Auto" Width="Auto" Margin="0,0,0,5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock  TextWrapping="Wrap" Grid.Column="0" Grid.Row="1" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DrugName'}"/>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NameStrengthFrequency">
                <Grid Grid.Column="0" Grid.Row="1" Height="Auto" Width="Auto" Margin="0,0,0,5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" Grid.Row="1" VerticalAlignment="Top">
                        <ctl:WrapPanel   >
                            <TextBlock  FontWeight="Bold" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DrugName'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='StrengthSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='Strength'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='FormNameSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='FormName'}"/>
                        </ctl:WrapPanel>
                    </Grid>
                    <Grid Grid.Column="0" Grid.Row="2" VerticalAlignment="Top">
                        <ctl:WrapPanel >
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom">
                                <TextBlock FontFamily="Courier New" FontSize="14" Margin="0,0,0,0" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DoseLabel'}" Foreground="#336699"/>
                                <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DOSEQTY'}"/>
                            </StackPanel>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DOSEQTYSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='RouteName'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='RouteNameSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='Frequency'}"/>
                        </ctl:WrapPanel>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NameFormFrequency" >
                <Grid Grid.Column="0" Grid.Row="1" Height="Auto" Width="Auto" Margin="0,0,0,5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" Grid.Row="1" VerticalAlignment="Top">
                        <ctl:WrapPanel>
                            <TextBlock  TextWrapping="Wrap" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DrugName'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='FormNameSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='FormName'}"/>
                        </ctl:WrapPanel>
                    </Grid>
                    <Grid Grid.Column="0" Grid.Row="2" VerticalAlignment="Top">
                        <ctl:WrapPanel>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom">
                                <TextBlock FontFamily="Courier New" Margin="0,0,0,0"  FontSize="14" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DoseLabel'}" Foreground="#336699"/>
                                <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DOSEQTY'}"/>
                            </StackPanel>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DOSEQTYSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='RouteName'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='RouteNameSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='Frequency'}"/>
                        </ctl:WrapPanel>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NameStrengthMedication">
                <Grid Grid.Column="0" Grid.Row="1" Height="Auto" Width="Auto" Margin="0,0,0,5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" Grid.Row="1" VerticalAlignment="Top">
                        <ctl:WrapPanel >
                            <TextBlock  FontWeight="Bold" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DrugName'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='StrengthSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='Strength'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='RouteNameSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='RouteName'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='MedicationTypeSeparator'}"/>
                            <TextBlock  Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='MedicationType'}"/>
                        </ctl:WrapPanel>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="DrugDetailsTemplateDefault">
                <Grid Height="Auto" Width="Auto" Margin="0,0,0,5" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock  TextWrapping="Wrap" Grid.Column="0" Grid.Row="1" Text="{Binding Converter={StaticResource dictionaryToStringConverter}, ConverterParameter='DrugName'}"/>
                </Grid>
            </DataTemplate>

            <Style TargetType="TextBlock" x:Key="ToolBar_TextBlock">
                <Setter Property="FontSize" Value="12" />
                <Setter Property="FontFamily" Value="Serif" />
            </Style>

            <Style TargetType="ListBoxItem" x:Key="ToolBar_ListBoxItem">
                <Setter Property="FontSize" Value="12" />
                <Setter Property="FontFamily" Value="Serif" />
            </Style>



      


        </ResourceDictionary>




    


    </UserControl.Resources>

    <Grid >
        <Grid.RowDefinitions>
        
            <RowDefinition Height="*"  />
            
        </Grid.RowDefinitions>
  
        <Grid  Grid.Row="0" >
        <Grid.RowDefinitions>

                <RowDefinition  Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="180" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
            <ScrollViewer Grid.Row="0" Grid.Column="0" VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Visible"  Height="795" x:Name="scrlviewr" VerticalAlignment="Top">
                <!--<Grid x:Name="grdaddchild"   Background="LightGray" VerticalAlignment="Top" Height="2300"></Grid>-->
                <!--<StackPanel x:Name="stkaddchild" Width="250" Height="1200" VerticalAlignment="Top" TextOptions.TextFormattingMode="Display"   >
                     
                </StackPanel>-->
                <TreeView x:Name="trvaddchkchild" Background="#cce0f8" ></TreeView>
            </ScrollViewer>
            <Grid x:Name="ParentLayoutroot" Grid.Row="0" Grid.Column="1" VerticalAlignment="Top"  >
             <Grid.RowDefinitions>
          
            <RowDefinition Height="*"  />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
                   <!--<ScrollViewer VerticalScrollBarVisibility="Auto" Grid.Row="0">today-->
    
               <Grid x:Name="LayoutRoot" Background="White"  Grid.Row="0" Grid.Column="0" VerticalAlignment="Top" >
        <Grid.Resources>
            <samplepages:DateTimeToCuiDateStringConverter x:Key="CuiDateConverter" />
            <samplepages:IntToVisibilityConverter x:Key="IntToVisibilityConverter" />
         
            <SolidColorBrush Color="#FF3A3A3A" x:Key="SectionHeader_Foreground_Brush" />
            <LinearGradientBrush x:Key="SectionHeader_Background_Brush" EndPoint="0.5,0" StartPoint="0.5,1">
                <GradientStop Color="#FF3A3A3A" Offset="0.05"/>
                <GradientStop Color="#FFFFFFFF" Offset="1"/>
                <GradientStop Color="#FF9FBFD1" Offset="0.05"/>
                <GradientStop Color="#FFFFFFFF" Offset="0"/>
            </LinearGradientBrush>
            <DataTemplate x:Key="SectionTemplate">
                <Border BorderThickness="2" 
                        x:Name="SectionRoot" SizeChanged="SectionRoot_SizeChanged" MouseDown="SectionRoot_MouseDown"  >
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition Height="*"  />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Grid.ColumnSpan="2" CornerRadius="1" Padding="1">
                            <Grid Background="{StaticResource SectionHeader_Background_Brush}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Margin="5,0,0,0" x:Name="secname" Text="{Binding SectionName}" FontWeight="Bold" Grid.Column="0"
                                               VerticalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"/>
                                <TextBlock x:Name="OutOfViewTitle" FontWeight="Bold" Grid.Column="1"
                                               VerticalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"/>

                                <StackPanel x:Name="SectionControlsPanel"  Orientation="Horizontal" Grid.Column="2" HorizontalAlignment="Right">
                                    <StackPanel x:Name="ActivityTypesList" Orientation="Horizontal" 
                                            Tag="{Binding SectionName}" Background="Transparent"
                                            Loaded="ActivityTypesList_Loaded" 
                                            Margin="0,0,35,0"
                                            />
                                    <local:LevelOfDetail x:Name="LevelOfDetail" 
                                                     Label="Level of detail"
                                                     IsTabStop="False"
                                                         FontWeight="Bold"
                                                 Foreground="{StaticResource SectionHeader_Foreground_Brush}"
                                                 NumberOfLevels="4" CurrentLevel="2"                                                  
                                                 Style="{StaticResource LevelOfDetailStyle}"
                                                 Background="Transparent" 
                                                 OnLevelOfDetailChange="LevelOfDetail_OnLevelOfDetailChange" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        <Grid Background="White" Grid.Row="1" Grid.Column="1" x:Name="GraphArea">
                            <ScrollViewer x:Name="ScrollViewer" SizeChanged="ScrollViewer_SizeChanged" Padding="0"
                                      Style="{StaticResource TimelineScrollViewerStyle}">
                                <ItemsControl x:Name="ItemsControl" ItemsSource="{Binding Graphs}" 
                                          SizeChanged="ItemsControl_SizeChanged" IsTabStop="False">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <DockPanel />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </ScrollViewer>
                            <Border Width="186" 
                                VerticalAlignment="Stretch" HorizontalAlignment="Left"
                                BorderThickness="1,0,1,0" BorderBrush="Black" Padding="5">
                                <TextBlock x:Name="LODMinMessage" Visibility="Collapsed" Text="Increase the level of detail to view individual timeline entries" 
                                       TextWrapping="Wrap" />
                            </Border>
                        </Grid>

                        <Grid x:Name="OutOfViewIndicators" Grid.Row="1">
                            <Border x:Name="ItemsOutOfViewTopArrow" 
                            HorizontalAlignment="Center" VerticalAlignment="Top" Grid.Row="1" 
                            >
                                <Grid>
                                    <Button IsTabStop="False" Focusable="False"
                                    Style="{StaticResource BasicButtonStyle}" Padding="3,2,3,2"
                                    Click="ItemsOutOfViewTopArrow_Click"
                                    ToolTipService.ToolTip="Click to scroll up"
                                    Visibility="{Binding Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=0, Path=ItemsOutViewTop}"
                                    >
                                        <StackPanel Margin="0">
                                            <Path Stretch="Fill" Height="6" VerticalAlignment="Center" Width="8" Data="M390,169 L384,175 L396,175 z"
                                                                                                Fill="{StaticResource SectionHeader_Foreground_Brush}" />
                                            <TextBlock x:Name="ItemsOutViewTop" HorizontalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"  Text="{Binding ItemsOutViewTop}" TextWrapping="Wrap" FontSize="10.667" FontWeight="Bold"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </Border>

                            <Border x:Name="ItemsOutOfViewBottomArrow"                             
                            HorizontalAlignment="Center" VerticalAlignment="Bottom" Grid.Row="1"                             
                            >
                                <Grid>
                                    <Button IsTabStop="False" Focusable="False"
                                    Style="{StaticResource BasicButtonStyle}" Padding="3,2,3,2"                                    
                                    Click="ItemsOutOfViewBottomArrow_Click"
                                    ToolTipService.ToolTip="Click to scroll down"
                                    Visibility="{Binding Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=0, Path=ItemsOutViewBottom}"
                                    >
                                        <StackPanel Margin="0">
                                            <TextBlock x:Name="ItemsOutViewBottom" HorizontalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"  Text="{Binding ItemsOutViewBottom}" TextWrapping="Wrap" FontSize="10.667" FontWeight="Bold"/>
                                            <Path Stretch="Fill" Height="6" Margin="0" VerticalAlignment="Center" Width="8" Data="M390,180.41667 L384,175 L396,175 z"
                        		    	Fill="{StaticResource SectionHeader_Foreground_Brush}" HorizontalAlignment="Center" RenderTransformOrigin="0.5,0.5" >
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform/>
                                                        <SkewTransform AngleX="0" AngleY="0"/>
                                                        <RotateTransform Angle="0"/>
                                                        <TranslateTransform/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>

                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>
            </DataTemplate>


                        <DataTemplate x:Key="SectionTemplateTemp">
                            <Grid>
                                <Border BorderThickness="0" 
                        x:Name="SectionRoot" SizeChanged="SectionRoot_SizeChanged" MouseDown="SectionRoot_MouseDown"  >
                      
                            </Border>
                            <TextBlock Margin="5,0,0,0" x:Name="secname" Text="{Binding SectionName}" FontWeight="Bold" Grid.Column="0"
                                               VerticalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"/>
                            </Grid>
                        </DataTemplate>



                        <DataTemplate x:Key="ObsSectionTemplate">
                <Border BorderThickness="1" BorderBrush="{StaticResource Control_BorderBrush_Brush}"
                         x:Name="SectionRoot" SizeChanged="SectionRoot_SizeChanged" MouseDown="SectionRoot_MouseDown" >
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition Height="*"  />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="25" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Grid.ColumnSpan="2" CornerRadius="1" Padding="1">
                            <Grid Background="{StaticResource SectionHeader_Background_Brush}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Margin="5,0,0,0" x:Name="secname" Text="{Binding SectionName}" FontWeight="Bold" Grid.Column="0"
                                               VerticalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"/>
                                <TextBlock x:Name="OutOfViewTitle" FontWeight="Bold" Grid.Column="1"
                                               VerticalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"/>

                                <StackPanel x:Name="SectionControlsPanel"  Orientation="Horizontal" Grid.Column="2" HorizontalAlignment="Right">
                                    <local:LevelOfDetail x:Name="LevelOfDetail" 
                                                     Label="Level of detail"
                                                     IsTabStop="False"
                                                         FontWeight="Bold"
                                                 Foreground="{StaticResource SectionHeader_Foreground_Brush}" Grid.Column="2" 
                                                 NumberOfLevels="2" CurrentLevel="2" 
                                                 HorizontalAlignment="Right" 
                                                 Style="{StaticResource LevelOfDetailStyle}"
                                                 Background="Transparent" 
                                                 OnLevelOfDetailChange="LevelOfDetail_OnLevelOfDetailChange" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        <Grid Background="White" Grid.Row="1" Grid.Column="1" x:Name="GraphArea">
                            <ScrollViewer x:Name="ScrollViewer" SizeChanged="ScrollViewer_SizeChanged" Padding="0"
                                      Style="{StaticResource TimelineScrollViewerStyle}"
                                      >
                                <ItemsControl x:Name="ItemsControl" ItemsSource="{Binding Graphs}" 
                                          SizeChanged="ItemsControl_SizeChanged" IsTabStop="False">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <DockPanel />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </ScrollViewer>
                            <Border Width="186" 
                                VerticalAlignment="Stretch" HorizontalAlignment="Left"
                                BorderThickness="1,0,1,0" BorderBrush="Black" Padding="5">
                            </Border>
                        </Grid>
                        <Grid x:Name="OutOfViewIndicators" Grid.Row="1">
                            <Border x:Name="ItemsOutOfViewTopArrow"
                            HorizontalAlignment="Center" VerticalAlignment="Top" Grid.Row="1" 
                            Visibility="{Binding Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=0, Path=ItemsOutViewTop}">
                                <Grid>
                                    <Button IsTabStop="False" 
                                    Style="{StaticResource BasicButtonStyle}" Padding="3,2,3,2"
                                    Click="ItemsOutOfViewTopArrow_Click"
                                    ToolTipService.ToolTip="Click to scroll up"
                                    >
                                        <StackPanel Margin="0">
                                            <Path Stretch="Fill" Height="6" VerticalAlignment="Center" Width="8" Data="M390,169 L384,175 L396,175 z"
                                                                                                Fill="{StaticResource SectionHeader_Foreground_Brush}" />
                                            <TextBlock x:Name="ItemsOutViewTop" HorizontalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"  Text="{Binding ItemsOutViewTop}" TextWrapping="Wrap" FontSize="10.667" FontWeight="Bold"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </Border>

                            <Border x:Name="ItemsOutOfViewBottomArrow"                                                     
                            HorizontalAlignment="Center" VerticalAlignment="Bottom" Grid.Row="1" 
                            Visibility="{Binding Converter={StaticResource IntToVisibilityConverter}, ConverterParameter=0, Path=ItemsOutViewBottom}"
                            >
                                <Grid>
                                    <Button IsTabStop="False" 
                                    Style="{StaticResource BasicButtonStyle}" Padding="3,2,3,2"                                    
                                    Click="ItemsOutOfViewBottomArrow_Click"
                                    ToolTipService.ToolTip="Click to scroll down"
                                    >
                                        <StackPanel Margin="0">
                                            <TextBlock x:Name="ItemsOutViewBottom" HorizontalAlignment="Center" Foreground="{StaticResource SectionHeader_Foreground_Brush}"  Text="{Binding ItemsOutViewBottom}" TextWrapping="Wrap" FontSize="10.667" FontWeight="Bold"/>
                                            <Path Stretch="Fill" Height="6" Margin="0" VerticalAlignment="Center" Width="8" Data="M390,180.41667 L384,175 L396,175 z"
                        		    	Fill="{StaticResource SectionHeader_Foreground_Brush}" HorizontalAlignment="Center" RenderTransformOrigin="0.5,0.5" >
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform/>
                                                        <SkewTransform AngleX="0" AngleY="0"/>
                                                        <RotateTransform Angle="0"/>
                                                        <TranslateTransform/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>

                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>
            </DataTemplate>

            <DataTemplate x:Key="PrescriptionEvent_issued">
                <Border x:Name="PrescriptionIssued" local:GraphBase.XOffset="-8" Height="16" Width="16" 
                        Background="White" BorderBrush="#FF555555" BorderThickness="1" CornerRadius="1"
                        Canvas.ZIndex="100" 
                        ToolTipService.ToolTip="Prescription issued - click for more information">
                    <Grid>
                        <Path Fill="Black" Stretch="Fill" Height="10" Width="10" 
                              Data="M102.03442,598.79645 L105.07018,597.00061 L106.78825,599.71387 C106.78825,599.71387 108.51028,595.74304 110.21724,593.60419 C112.00967,591.35822 114.89314,591.42316 114.89314,591.42316 C114.89314,591.42316 111.57813,596.39594 110.83144,597.41412 C109.6446,599.03241 107.15683,604.13837 107.15683,604.13837 z" 
                              HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Grid>
                </Border>
            </DataTemplate>

            <DataTemplate x:Key="MedsAdminEvent_completed">
                <Border x:Name="CompletedEvent" local:GraphBase.XOffset="-8" Height="16" Width="16" 
                        Background="White" BorderBrush="#FF555555" BorderThickness="1" CornerRadius="1"
                        Canvas.ZIndex="100" 
                        ToolTipService.ToolTip="Administration event - click for more information">
                    <Grid>
                        <Path Fill="Black" Stretch="Fill" Height="10" Width="10" 
                              Data="M102.03442,598.79645 L105.07018,597.00061 L106.78825,599.71387 C106.78825,599.71387 108.51028,595.74304 110.21724,593.60419 C112.00967,591.35822 114.89314,591.42316 114.89314,591.42316 C114.89314,591.42316 111.57813,596.39594 110.83144,597.41412 C109.6446,599.03241 107.15683,604.13837 107.15683,604.13837 z" 
                              HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Grid>
                </Border>
            </DataTemplate>
            <DataTemplate x:Key="MedsAdminEvent_late">
                <Border Canvas.ZIndex="100" BorderThickness="1" Background="White" BorderBrush="#FF555555" 
                        local:GraphBase.XOffset="-8" Height="16" Width="16" CornerRadius="1"
                        ToolTipService.ToolTip="Late administration event - click for more information"
                        >
                    <TextBlock Text="L" Foreground="Black" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" />
                </Border>
            </DataTemplate>

            <DataTemplate x:Key="MedsAdminEvent_planned">
                <Rectangle Canvas.ZIndex="100" local:GraphBase.XOffset="-8" Height="16" Width="16" Stroke="Black" 
                           StrokeDashArray="3 2" StrokeThickness="1" 
                           Fill="White"
                           ToolTipService.ToolTip="Planned administration event - click for more information"
                           />
            </DataTemplate>

            <!-- *** Do not use this DataTemplate in clinical applications. ***
                 The display of medications of Significant Duration was not explored in the
                 'Design Guidance – Timeline View' document. 
                 Any visual representation of these events in Timeline will need to be re-evaluated in line
                 with the more up-to-date guidance published in the 'Design Guidance – Drug Administration' document. -->
            <DataTemplate x:Key="MedsAdminEvent_started">
                <Border Canvas.ZIndex="100" BorderBrush="#FF555555" Height="16" Background="White" 
                        BorderThickness="1" Width="16" CornerRadius="1"                        
                        ToolTipService.ToolTip="Start of continuous administration event - click for more information"
                        >
                    <Grid ScrollViewer.VerticalScrollBarVisibility="Visible"   ScrollViewer.HorizontalScrollBarVisibility ="Visible">
                        <Path Fill="Black" Stretch="Fill" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center" 
                              Width="10" Data="M7.8898296,0 L0,7.9657197 L15.999992,8.0024977 z" 
                              RenderTransformOrigin="0.5,0.5" Stroke="White">
                            <Path.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform/>
                                    <SkewTransform/>
                                    <RotateTransform Angle="90"/>
                                    <TranslateTransform/>
                                </TransformGroup>
                            </Path.RenderTransform>
                        </Path>
                    </Grid>
                </Border>
            </DataTemplate>

            <!-- *** Do not use this DataTemplate in clinical applications. ***
                 The display of medications of Significant Duration was not explored in the
                 'Design Guidance – Timeline View' document. 
                 Any visual representation of these events in Timeline will need to be re-evaluated in line
                 with the more up-to-date guidance published in the 'Design Guidance – Drug Administration' document. -->
            <DataTemplate x:Key="ContinuousMedsAdminEvent_started">
                <Border Canvas.ZIndex="100" BorderBrush="#FF555555" Height="16" Background="White" 
                        BorderThickness="1" Width="16" CornerRadius="1"                        
                        ToolTipService.ToolTip="Start of continuous administration event - click for more information"
                        >
                    <Grid>
                        <Path Fill="Black" Stretch="Fill" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center" 
                              Width="10" Data="M7.8898296,0 L0,7.9657197 L15.999992,8.0024977 z" 
                              RenderTransformOrigin="0.5,0.5" Stroke="White">
                            <Path.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform/>
                                    <SkewTransform/>
                                    <RotateTransform Angle="90"/>
                                    <TranslateTransform/>
                                </TransformGroup>
                            </Path.RenderTransform>
                        </Path>
                    </Grid>
                </Border>
            </DataTemplate>

            <!-- *** Do not use this DataTemplate in clinical applications. ***
                 The display of medications of Significant Duration was not explored in the
                 'Design Guidance – Timeline View' document. 
                 Any visual representation of these events in Timeline will need to be re-evaluated in line
                 with the more up-to-date guidance published in the 'Design Guidance – Drug Administration' document. -->
            <DataTemplate x:Key="ContinuousMedsAdminEvent_completed">
                <samplepages:ContinuousAdministrationEvent Canvas.ZIndex="100" Width="{Binding X1X2Pixel}" Height="16"
                      />
            </DataTemplate>

            <DataTemplate x:Key="MEDICATIONS_InterpolationLine">
                <samplepages:CurvedInterpolationLine ToolTipService.ToolTip="Click for more information"
                                                     />
            </DataTemplate>
            <DataTemplate x:Key="MEDICATIONS_InterpolationLineOneTime">
                <samplepages:CurvedInterpolationLine HasDuration="False" 
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
            </DataTemplate>
            <DataTemplate x:Key="MEDICATIONS_InterpolationLineOpenDuration">
                <samplepages:CurvedInterpolationLine OpenDuration="True" HasDuration="False"
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
            </DataTemplate>

            <DataTemplate x:Key="PROBLEMS_InterpolationLine">
                <samplepages:CurvedInterpolationLine ToolTipService.ToolTip="Click for more information"
                                                     />
            </DataTemplate>
            <DataTemplate x:Key="PROBLEMS_InterpolationLineOneTime">
                <samplepages:CurvedInterpolationLine HasDuration="False" 
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
            </DataTemplate>
            <DataTemplate x:Key="PROBLEMS_InterpolationLineOpenDuration">
                <samplepages:CurvedInterpolationLine OpenDuration="True" HasDuration="False"
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
            </DataTemplate>


                <DataTemplate x:Key="EXAMS_InterpolationLine">
                    <samplepages:CurvedInterpolationLine ToolTipService.ToolTip="Click for more information"
                                                     />
                </DataTemplate>
                <DataTemplate x:Key="EXAMS_InterpolationLineOneTime">
                    <samplepages:CurvedInterpolationLine HasDuration="False" 
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
                </DataTemplate>
                <DataTemplate x:Key="EXAMS_InterpolationLineOpenDuration">
                    <samplepages:CurvedInterpolationLine OpenDuration="True" HasDuration="False"
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
                </DataTemplate>




                <DataTemplate x:Key="LAB ORDERS_InterpolationLine">
                    <samplepages:CurvedInterpolationLine ToolTipService.ToolTip="Click for more information"
                                                     />
                </DataTemplate>
                <DataTemplate x:Key="LAB ORDERS_InterpolationLineOneTime">
                    <samplepages:CurvedInterpolationLine HasDuration="False" 
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
                </DataTemplate>
                <DataTemplate x:Key="LAB ORDERS_InterpolationLineOpenDuration">
                    <samplepages:CurvedInterpolationLine OpenDuration="True" HasDuration="False"
                                                     ToolTipService.ToolTip="Click for more information"
                                                     />
                </DataTemplate>


            </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="25" />
            <RowDefinition Height="*"  />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0">
            <!--<TextBlock Text="Select scenario" Margin="3,0,20,0" />-->
            <!--<RadioButton x:Name="Primarycare" Content="Primary care" Tag="2" />
            <RadioButton x:Name="Secondarycare" Content="Secondary care" Tag="1" IsChecked="True" Margin="10,0,0,0"/>-->
        </StackPanel>


  


            <local:TimeActivityGraphHost x:Name="TimeActivityGraphHost" SectionTemplate="{StaticResource SectionTemplate}"
                                  SectionInitialized="TimeActivityGraphHost_SectionInitialized"
                                  Style="{StaticResource TimeActivityGraphHost}"
                                  SectionReset="TimeActivityGraphHost_SectionReset"    
                                  Refresh="TimeActivityGraphHost_Refresh"
                                  BorderBrush="{StaticResource Control_BorderBrush_Brush}" 
                                  BorderThickness="1"
                                  IsTabStop="False"
                                  FontSize="12"
                                  FontFamily="Arial" Grid.RowSpan="2"   />






            <samplepages:ModalDialog x:Name="TestDetailsDialog"  Grid.RowSpan="2">
                <samplepages:ModalDialog.DialogContent>
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Text="Lab Orders" Margin="0,0,0,10"  Style="{StaticResource TextBlockStyle}" FontSize="16" Opacity="0.5" />

                        <local:LabeledContentControl BorderThickness="0" Label="Lab Order Name"
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding AdditionalInformation.MedicationName}"
                                                 VerticalContentAlignment="Top"
                                                 Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=AdditionalInformation.MedicationName}"
                                                 Grid.Row="1"
                                                 />


                        <StackPanel Grid.Row="2" Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}}">
                            <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                            <local:LabeledContentControl BorderThickness="0" Label="end time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding EndDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=EndDate}"/>
                        </StackPanel>
                        <StackPanel Grid.Row="3"  Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Collapsed}">
                            <local:LabeledContentControl BorderThickness="0" Label="time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                        </StackPanel>
                        <Button IsTabStop="False" Content="Close" 
                            Grid.Row="4" Grid.Column="1" 
                            HorizontalAlignment="Right" 
                            Style="{StaticResource BasicButtonStyle}" Click="CloseTestDialog_Click"/>
                                <Button IsTabStop="False" Content="Open" 
                            Grid.Row="4" Grid.Column="1" 
                            HorizontalAlignment="Left"  
                           Width="0" Height="0" Click="OpenTestDialog_Click"/>
                            </Grid>
                </samplepages:ModalDialog.DialogContent>
            </samplepages:ModalDialog>






            <samplepages:ModalDialog x:Name="ExamDetailsDialog"  Grid.RowSpan="2">
                <samplepages:ModalDialog.DialogContent>
                    <Grid Margin="10">
                          <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                     
                                </Grid.RowDefinitions>
                        <TextBlock Text="Exams" Margin="0,0,0,10"  Style="{StaticResource TextBlockStyle}" FontSize="16" Opacity="0.5" />
                               
                                <local:Label  Text ="{Binding AdditionalInformation.MedicationName}"  Opacity="0"  Width="0" Height="0"></local:Label>

                                 
                        <local:LabeledContentControl BorderThickness="0" Label="Exam Name" 
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding AdditionalInformation.MedicationName}"
                                                 VerticalContentAlignment="Top"
                                                 Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=AdditionalInformation.MedicationName}"
                                                 Grid.Row="1"
                                                 />


                                <local:LabeledContentControl BorderThickness="0"  
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding   AdditionalInformation.MedicationID}"
                                                 VerticalContentAlignment="Top"
                                              Width="0" Height="0"
                                                 Grid.Row="1"
                                                 />
                                <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        
                                                        Content="{Binding StartDate}"                                                        
                                                          Width="0" Height="0"
                                                 Grid.Row="1"
                                                       />
                                <local:LabeledContentControl BorderThickness="0" Label="ExStatus"
                                                        
                                                        Content="{Binding AdditionalInformation.ExamStatus}"                                                        
                                                          Width="0" Height="0"
                                                 Grid.Row="1"
                                                       />
                                <local:LabeledContentControl BorderThickness="0" Label="Exvisitid"
                                                        
                                                        Content="{Binding AdditionalInformation.VisitID}"  
                                                             
                                                          Width="0" Height="0"
                                                 Grid.Row="1"
                                                       />


                                <local:LabeledContentControl BorderThickness="0" Label="ExsTemplateName"
                                                        
                                                        Content="{Binding AdditionalInformation.sTemplateName}"                                                        
                                                          Width="0" Height="0"
                                                 Grid.Row="1"
                                                       />

                                <StackPanel Grid.Row="2"   Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}}">
                            <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                            <local:LabeledContentControl  BorderThickness="0" Label="end time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding EndDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=EndDate}"/>
                        </StackPanel>
                        <StackPanel Grid.Row="3"   Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Collapsed}">
                            <local:LabeledContentControl BorderThickness="0" Label="time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                        </StackPanel>
                        <Button IsTabStop="False" Content="Close" 
                            Grid.Row="4"  
                            HorizontalAlignment="Right" 
                            Style="{StaticResource BasicButtonStyle}" Click="CloseExamsDialog_Click"/>


                                <Button IsTabStop="False" Content="Open" 
                            Grid.Row="4" 
                            HorizontalAlignment="Left"  
                           Width="0" Height="0"  Click="OpenExamsDialog_Click" />



                            </Grid>
                </samplepages:ModalDialog.DialogContent>
            </samplepages:ModalDialog>





            <samplepages:ModalDialog x:Name="MedsDetailsDialog"  Grid.RowSpan="2">
            <samplepages:ModalDialog.DialogContent>
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="Medication" Margin="0,0,0,10"  Style="{StaticResource TextBlockStyle}" FontSize="16" Opacity="0.5" />

                    <local:LabeledContentControl BorderThickness="0" Label="product name"
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding AdditionalInformation.MedicationName}"
                                                 VerticalContentAlignment="Top"
                                                 Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=AdditionalInformation.MedicationName}"
                                                 Grid.Row="1"
                                                 />

                    <local:LabeledContentControl BorderThickness="0" Label="dosage"
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding AdditionalInformation.Frequency}"
                                                 VerticalContentAlignment="Top"
                                                 Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=AdditionalInformation.Frequency}"
                                                 Grid.Row="2"
                                                 />

                    <local:LabeledContentControl BorderThickness="0" Label="supply"
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding AdditionalInformation.Form}"
                                                 VerticalContentAlignment="Top"
                                                 Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=AdditionalInformation.Form}"
                                                 Grid.Row="3"
                                                 />

                    <StackPanel Grid.Row="4" Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}}">
                        <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                        <local:LabeledContentControl BorderThickness="0" Label="end time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding EndDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=EndDate}"/>
                    </StackPanel>
                    <StackPanel Grid.Row="4"  Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Collapsed}">
                        <local:LabeledContentControl BorderThickness="0" Label="time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                    </StackPanel>
                    <Button IsTabStop="False" Content="Close" 
                            Grid.Row="5" Grid.Column="1" 
                            HorizontalAlignment="Right" 
                            Style="{StaticResource BasicButtonStyle}" Click="CloseMedsDialog_Click"/>
                              
                    <Button IsTabStop="False" Content="Open" 
                            Grid.Row="5" Grid.Column="1" 
                            HorizontalAlignment="Left" 
                          Width="0" Height="0"  Click="CloseMedsDialog_Click"/>
                            </Grid>
            </samplepages:ModalDialog.DialogContent>
        </samplepages:ModalDialog>

        <samplepages:ModalDialog x:Name="SecondaryCareMedsDetailsDialog"  Grid.RowSpan="2">
            <samplepages:ModalDialog.DialogContent>
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="Medication" Margin="0,0,0,10"  Style="{StaticResource TextBlockStyle}" FontSize="16" Opacity="0.5" />

                    <local:MedicationLabel BrandName="{Binding AdditionalInformation.BrandName}"
                                           Dose="{Binding AdditionalInformation.Dose}"
                                           DoseDuration="{Binding AdditionalInformation.DoseDuration}"
                                           DoseLabel="{Binding AdditionalInformation.DoseLabel}"
                                           FluidStrength="{Binding AdditionalInformation.FluidStrength}"
                                           SolidStrength="{Binding AdditionalInformation.SolidStrength}"
                                           Form="{Binding AdditionalInformation.Form}"
                                           Frequency="{Binding AdditionalInformation.Frequency}"
                                           MedicationName="{Binding AdditionalInformation.MedicationName}"
                                           Mode="Full"
                                           Rate="{Binding AdditionalInformation.Rate}"
                                           Route="{Binding AdditionalInformation.Route}"
                                           Grid.Row="1"
                                           BorderThickness="0"
                                           Margin="0,0,0,10"
                                           />


                    <StackPanel Grid.Row="2" Margin="2,0,0,10" Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}}">
                        <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                        <local:LabeledContentControl BorderThickness="0" Label="end time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding EndDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=EndDate}"/>
                    </StackPanel>
                    <StackPanel Grid.Row="2" Margin="2,0,0,10" Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Collapsed}">
                        <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                    </StackPanel>
                    <Button IsTabStop="False" Content="Close" 
                            Grid.Row="3" Grid.Column="1" 
                            HorizontalAlignment="Right" 
                            Style="{StaticResource BasicButtonStyle}" Click="CloseSecondaryCareMedsDetailsDialog_Click"/>
                </Grid>
            </samplepages:ModalDialog.DialogContent>
        </samplepages:ModalDialog>

        <samplepages:ModalDialog x:Name="ProblemsDialog"  Grid.RowSpan="2">
            <samplepages:ModalDialog.DialogContent>
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Text="Problem" Margin="0,0,0,10"  Style="{StaticResource TextBlockStyle}" FontSize="16" Opacity="0.5" />


                                <local:LabeledContentControl BorderThickness="0"  
                                                 Padding="0,0,10,0"
                                                 Margin="0,0,0,10"
                                                 Content="{Binding   AdditionalInformation.MedicationID}"
                                                 VerticalContentAlignment="Top"
                                              Width="0" Height="0"
                                                 Grid.Row="1"
                                                 />
                                
                                <local:LabeledContentControl BorderThickness="0" Label="Exvisitid"
                                                        
                                                        Content="{Binding AdditionalInformation.VisitID}"                                                        
                                                          Width="0" Height="0"
                                                 Grid.Row="1"
                                                       />


                                <local:LabeledContentControl BorderThickness="0" Label="problem"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Grid.Row="1"
                                                        Content="{Binding AdditionalInformation.MedicationName}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=AdditionalInformation.MedicationName}"/>
                    <StackPanel Grid.Row="2" Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}}">
                        <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                        <local:LabeledContentControl BorderThickness="0" Label="end time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding EndDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=EndDate}"/>
                    </StackPanel>
                    <StackPanel Grid.Row="2" Visibility="{Binding HasDuration, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Collapsed}">
                        <local:LabeledContentControl BorderThickness="0" Label="start time"
                                                        Padding="0,0,10,0"
                                                        Margin="0,0,0,10"
                                                        Content="{Binding StartDate, Converter={StaticResource CuiDateConverter}, ConverterParameter=true}"                                                        
                                                        VerticalContentAlignment="Top"
                                                        Visibility="{Binding Converter={StaticResource NullEmptyToVisibilityConverter}, Path=StartDate}"/>
                    </StackPanel>
                    <Button Content="Close" Grid.Row="3" IsTabStop="False"
                            HorizontalAlignment="Right" 
                            Style="{StaticResource BasicButtonStyle}" Click="CloseProblemsDialog_Click"/>

                                <Button Content="Open" Grid.Row="3" IsTabStop="False"
                            HorizontalAlignment="Left" 
                             Width="0" Height="0" Click="OpenProblemsDialog_Click"/>
                            </Grid>
            </samplepages:ModalDialog.DialogContent>
        </samplepages:ModalDialog>

        <samplepages:ModalDialog x:Name="EventsDialog"  Grid.RowSpan="2">
            <samplepages:ModalDialog.DialogContent>
                <samplepages:ActivityDialog Close="CloseEventsDialog_Click" />
            </samplepages:ModalDialog.DialogContent>
        </samplepages:ModalDialog>
         </Grid>
                <!--</ScrollViewer> today-->
            </Grid>
    </Grid>
          
        </Grid>
</UserControl>
